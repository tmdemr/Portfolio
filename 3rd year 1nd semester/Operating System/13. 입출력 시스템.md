## 13.2 입출력 하드웨어
- 많은 종류의 입출력 장치들
- 표준 하드웨어 커널의 기본 개념

> PC는 보통 PCI 버스 사용
> - 장치들간의 전송을 빠르게 수행


### 폴링(Polling) **입출력 방식 중요**
- 장치의 상태 결정
  - 명령 준비 완료
  - 사용 중
  - 오류

### 인터럽트
- 매 명령어 수행 시 인터럽트 요청 라인 검사

- 입출력 장치는 요청 라인을 통해 신호를 보냄
- 인터럽트 핸들러 - 인터럽트 수령
- 인터럽트를 마스크하여 무시하거나 지연 가능
- 인터럽트 벡터
  - 인터럽트 핸들러의 메모리 주소(메모리에 인터럽트 처리 루틴에 대한 주소를 저장함.)
  - 특정 인터럽트를 올바른 인터럽트 핸들러로 처리
  - 우선순위 기반
  - 몇몇 마스크 불가 인터럽트 가능

### DMA
- 대규모 데이터 이동에 대해 PIO를 회피
  - PIO-CPU가 하드웨어 상태 비트 반복 검사
- DMA 제어기 필요
- CPU를 거치지 않고 입출력 장치와 메모리 사이에 직접 데이터를 전송

## 13.3 응용 입/출력 인터페이스
- 입출력 시스템 호출 - 장치 동작을 일반적은 계층으로 캡슐화
- 장치 구동기 계층 - 커널로부터 입출력 장치들간의 차이를 숨김
- 다양한 수준의 장치들
  - 문자 스트림과 블록
  - 순차접근과 임의 접근
  - 공유 가능 또는 전용
  - 동작 속도
  - Read-Write, 읽기 전용, 또는 쓰기 전용

> - 리눅스에서는 입출력 장치도 파일처럼 처리함
> - 입출력 장치들을 추상화하고, 내무적인 디바이스마다 입출력 방식을 다르게 설정하여 실행함.

### 블록 장치와 문자 장치
- 블록 장치 - 디스크 드라이브 등
  - read, write, seek 명령
  - Raw I/O 또는 파일-시스템 접근
  - 메모리 맵 파일 저븐

- 문자 장치 - 키보드, 마우스, 직렬 포트 등
  - get, put 명령 포함
  - 인터페이스 계층 위의 라이브러리 이용
    
### 네트웍 장치
- 자신의 인터페이스를 가지는 블록과 문자 장치와는 다름
- Unix와 Windows NT/9u2000 는 소켓 인터페이스 사용
  - 네트웍 프로토콜과 동작을 분리
  - select 기능 포함
- 넓은 접근 방식 존재
  - pipes, FIFOs, streams, queues, mailboxex

### 봉쇄형 입출력과 비봉쇄형 입출력
- Blocking - 입출력이 완료될 때 까지 처리 지연
  - 간편하고 일해하기 쉬움
  - 특정 요구에는 불충분함
- Nonblocking - 가능한 한 많은 입출력 호출 수행
  - 사용자 인터페이스, 자료 복사 함게 수행
  - 멀티스레딩을 통해 구현
  - 빠른 입출력 시스템 호출의 반환
- Asynchronous - 입출력 수행 동안 프로세스 수행
  - 사용하기 어려움
  - 입출력이 완료될 때 프로세스에게 신호를 보냄
- 스케쥴링
  - 장치 큐를 통한 입출력 순서 재배치
  - 운영체제 - 공평한 입출력 처리

### 커널 입출력 부시스템
- 캐시 - 자료를 복사 저장하는 빠른 메모리
- 스풀링 - 출력 데이터를 보관하는 버퍼

- 장치 예약 - 장치에 대한 배제적 접근 제공

### 오류 처리
- OS는 디스크 읽기, 장치 사용할 수 없음. 일시적인 쓰기 오류로부터 복구 가능
- 입출력 요청이 실패할 때 대부분 오류 발생


### 봉쇄형 입출력과 비봉쇄형 입출력

### 13.4 커널 입출력 부시스템
- 스케쥴링
  - CPU와 입출력장치간의 속도 차이를 해결하기 위해 사용
  - 장치 큐를 통한 입출력 순서 재배치
  - 운영체제 - 공평한 입출력 처리

- 버퍼링
- 캐싱
  - 자료를 복사 저장하는 메모리
- 스풀링
- 장치 예약


### 13.4.6 커널 자료 구조
- 커널은 입/출력 구성에 대한 상태 정보 유지
- 버퍼, 메모리 할당, 오염 블록 추적을 위한 복잡한 자료 구조 제공

### 13.5 입/출력 요청의 처리
- 한 프로세스가 디스크로부터 파일을 읽는 경우 :
  - 파일을 가진 장치 결정
  - 파일명으로부터 장치에서의 위치 파악
  - 디스크로부터 물리적 데이터를 읽어 버퍼에 저장
  - 요청 프로세스가 사용 가능한 데이터로 변환
  - 프로세스에 제어권 반환(PC값을 바꾸고, 제어권을 CPU에게 반환)

### 13.7 성능
- 입/출력은 시스템 성능의 중요한 요소:
  - 장치 구동기, 커널 입출력 코드를 실행하도록 CPU에게 요구
  - 인터럽트로 인한 문맥 교환
  - 커널 버퍼와 응용 프로그램 공간 간 데이터 복사
  - 네트워크 트래픽도 상당한 부담


